<!DOCTYPE html>
<head>
    <link
        rel="preload"
        href="https://cdn.jsdelivr.net/npm/@microsoft/fast-element@1.8.0/dist/fast-element.min.js"
        as="script"
        crossorigin="anonymous"
    />
</head>
<body>
    <div id="template"></div>
</body>
<script type="module" src="index.js">

    var __decorate =
        (this && this.__decorate) ||
        function (decorators, target, key, desc) {
            var c = arguments.length,
                r =
                    c < 3
                        ? target
                        : desc === null
                        ? (desc = Object.getOwnPropertyDescriptor(target, key))
                        : desc,
                d;
            if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
                r = Reflect.decorate(decorators, target, key, desc);
            else
                for (var i = decorators.length - 1; i >= 0; i--)
                    if ((d = decorators[i]))
                        r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
            return c > 3 && r && Object.defineProperty(target, key, r), r;
        };
    import {
        css,
        FASTElement,
        html,
        observable,
    } from "https://cdn.jsdelivr.net/npm/@microsoft/fast-element@1.8.0/dist/fast-element.min.js";
    const itemCount = 10000;
    const itemValueCount = 99;
    const updateCount = 6;
    function measureMemory() {
        if ("gc" in window && "memory" in performance) {
            // Report results in MBs\
            window.gc();
            window.usedJSHeapSize = performance.memory.usedJSHeapSize / 1e6;
        } else {
            window.usedJSHeapSize = 0;
        }
    }
    function makeItem(prefix) {
        const o = {};
        for (let i = 0; i < itemValueCount; i++) {
            o["value" + i] = prefix + ": " + i;
        }
        return o;
    }
    function generateData(count) {
        const data = [];
        for (let i = 0; i < count; i++) {
            data.push(makeItem(i));
        }
        return data;
    }
    const data = generateData(itemCount);
    const otherData = generateData(itemCount * 2).slice(itemCount);
    class XItem extends FASTElement {
        render() {
            return html`
                <div @click="${this.onClick}" class="item">
                    <x-thing
                        .from="${this.item.value0}"
                        .time="${this.item.value1}"
                        .subject="${this.item.value2}"
                    ></x-thing>
                    <x-thing
                        .from="${this.item.value3}"
                        .time="${this.item.value4}"
                        .subject="${this.item.value5}"
                    ></x-thing>
                    <x-thing
                        .from="${this.item.value6}"
                        .time="${this.item.value7}"
                        .subject="${this.item.value8}"
                    ></x-thing>
                    <x-thing
                        .from="${this.item.value9}"
                        .time="${this.item.value10}"
                        .subject="${this.item.value11}"
                    ></x-thing>
                    <x-thing
                        .from="${this.item.value12}"
                        .time="${this.item.value13}"
                        .subject="${this.item.value14}"
                    ></x-thing>
                    <x-thing
                        .from="${this.item.value15}"
                        .time="${this.item.value16}"
                        .subject="${this.item.value17}"
                    ></x-thing>
                </div>
            `;
        }
        onClick(e) {
            console.log(e.type);
        }
    }
    XItem.styles = css`
        .item {
            display: flex;
        }
    `;
    __decorate([observable], XItem.prototype, "item", void 0);
    customElements.define("x-item", XItem);
    class XApp extends FASTElement {
        constructor() {
            super(...arguments);
            this.items = data;
        }
        render() {
            return html`
                ${this.items.map(
                    item => html`
                        <x-item .item="${item}"></x-item>
                    `
                )}
            `;
        }
    }
    __decorate([observable], XApp.prototype, "items", void 0);
    customElements.define("x-app", XApp);
    (async () => {
        const container = document.createElement("div");
        document.body.appendChild(container);
        let el;
        const create = () => {
            const el = document.createElement("x-app");
            return container.appendChild(el);
        };
        const destroy = () => {
            container.innerHTML = "";
        };
        const getTestStartName = name => `${name}-start`;
        const updateComplete = () => new Promise(r => requestAnimationFrame(r));
        const render = async () => {
            const test = "render";
            const start = getTestStartName(test);
            performance.mark(start);
            create();
            await updateComplete();
            performance.measure(test, start);
            measureMemory();
            // destroy();
        };
        await render();
        // const update = async () => {
        //     const test = "update";
        //     el = create();
        //     const start = getTestStartName(test);
        //     performance.mark(start);
        //     for (let i = 0; i < updateCount; i++) {
        //         el.items = i % 2 ? otherData : data;
        //         await updateComplete();
        //     }
        //     performance.measure(test, start);
        //     destroy();
        // };
        // await update();
        // // Log
        // performance
        //     .getEntriesByType("measure")
        //     .forEach(m => console.log(`${m.name}: ${m.duration.toFixed(3)}ms`));
    })();
    // console.log("test");
    // performance.mark("start");
    // console.log("test");
    // const container = document.createElement("div");
    // const el = document.createElement("span");
    // container.appendChild(el);
    // performance.measure("render", "start");
    //# sourceMappingURL=index.js.map
</script>
